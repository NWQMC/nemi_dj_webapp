{% extends "base.html" %}
{% block title %}NEMI Method Summary{% endblock %}
{% block content %}
	<h2>Method Summary</h2>
	{% if data %}
		<table class="info-table">
			<tr>
				<th>Method Information</th>
				<td><b>Descriptive Name: </b>{{ data.method_descriptive_name }}<br/>
					<b>Official Name: </b>{{ data.method_official_name }}<br/>
					<b>Method Number: </b>{{ data.source_method_identifier|safe }}<br/>
					<b>Revision: </b>{{ data.revision_information }}
				</td>
			</tr>
			<tr>
				<th>Media</th>
				<td><b>Media: </b>{{ data.media_name }}&nbsp;&nbsp;&nbsp;&nbsp;
					{% if data.waterbody_type %}
					   <b>       Waterbody type: </b>{{ data.waterbody_type }}
					{% endif %}
				</td>
			</tr>
			<tr><th>Subcategory</th><td>{{ data.method_subcategory }}</td></tr>
			<tr><th>Method Source</th>
				<td><a title="Click to show/hide details" href="javascript:show_hide('#method-source-detail')">{{ data.method_source_name }}</a>
					<div id="method-source-detail" style="display: none;">
						<table class="inside-table">
							<tr><th>Contact Information:</th><td>{{ data.method_source_contact|safe }}</td></tr>
							<tr><th>URL:</th><td>{{ data.method_source_url }}</td></tr>
						</table>
					</div>
				</td>
			</tr>
			<tr><th>Citation</th>
				<td><a title="Click to show/hide details" href="javascript:show_hide('#citation-detail')">{{ data.source_citation_name }}</a>
					<div id="citation-detail" style="display: none;">
						<table class="inside-table">
							<tr><th>Method Number:</th><td>{{ data.source_method_identifier|safe }}</td></tr>
							<tr><th>Method Official Name:</th><td>{{ data.method_official_name }}</td></tr>
							<tr><th>Citation Information:</th><td>{{ data.source_citation_information }}</td></tr>
						</table>
					</div>
				</td>
			</tr>
			<tr><th>Brief Method Summary</th><td>{{ data.brief_method_summary|safe }}</td></tr>
			<tr><th>Scope and Application</th><td>{{ data.scope_and_application|safe }}</td></tr>
			<tr><th>Applicable Conc Range</th><td>{{ data.applicable_conc_range }}</td></tr>
			<tr><th>Method Download</th><td>{% include "method_download.html" %}</td></tr>
			<tr><th>Interferences</th><td>{{ data.interferences|safe }}</td></tr>
			<tr><th>QC Requirements</th><td>{{ data.qc_requirements|safe }}</td></tr>
			<tr><th>Sample Handling</th><td>{{ data.sample_handling|safe }}</td></tr>
			<tr><th>Max Holding Time</th><td>{{ data.max_holding_time }}</td></tr>
			<tr><th>Relative Cost/Effort</th><td>{{ data.relative_cost }}</td></tr>
			<tr><th>Sample Prep Method(s)</th><td>{{ data.sample_prep_methods }}</td></tr>
		</table>
	{% else %}
	<p>No data found</p>
	{% endif %}
	<hr/>
	<h4>Method <i>{{data.source_method_identifier|safe }}</i> has {{ analyte_data|length }} analyte{{ analyte_data|pluralize }} associated with it.</h4>
	{% if analyte_data %}
		<p>
		<a class="popup"
			title="Download the results as a tab-separated values format, which can be opened by any spreadsheet application."
			href = {% url search-method_analyte_export data.method_id %}>Export results as a tab separated text file (can be opened in any text editor or spreadsheet)
		</a>
		</p>
		<table class="data-table">
			<tr>
				<th>Analyte</th>
				<th>Detection<br/>Level</th>
				<th>Bias</th>
				<th>Precision</th>
				<th>Pct False<br/>Positive</th>
				<th>Pct False<br/>Negative</th>
				<th>Spiking<br/>Level</th>
			</tr>
			{% for a in analyte_data %}
				<tr>
					<td>{% include "analyte_synonyms.html" with analyte_name=a.r.analyte_name|force_escape analyte_code=a.r.analyte_code syn=a.syn  %}</td>
					<td>
						{% if a.dl_value == 999 %}
							N/A
						{% else %}
							{{ a.dl_value|floatformat:2 }} <span class="abbrev" title="{{ a.dl_units_description }}">{{ a.dl_units }}</span>
						{% endif %}
					</td>
					<td>
						{% if a.accuracy == -999 %}
							N/A
						{% else %}
							{{ a.accuracy|floatformat:0}}<span class="abbrev" title="{{ a.accuracy_units_description }}">{{ a.accuracy_units }}</span>
						{% endif %}
					</td>
					<td>
						{% if a.precision == 999 %}
							N/A
						{% else %}
							{{ a.precision|floatformat:2 }} <span class="abbrev" title="{{ a.precision_units_description }}">{{ a.precision_units }}</span>
						{% endif %}
					</td>
					<td>{{ a.false_positive_value|default_if_none:"" }}</td>
					<td>{{ a.false_negative_value|default_if_none:"" }}</td>
					<td>
						{% if a.prec_acc_conc_used %}
							{{ a.prec_acc_conc_used|floatformat:2 }} <span class="abbrev" title="{{ a.dl_units_description }}">{{ a.dl_units }}</span>
						{% endif %}
					</td>
				</tr>
			{% endfor %}
		</table>
	{% endif %}	
	{% if notes %}
	<div style="position: relative; top: 20px;">
		<table class="info-table">
			<tr><th>Precision Descriptor Notes</th><td>{{ notes.0.precision_descriptor_notes|safe }}</td></tr>
			<tr><th>Detection Level Note</th><td>{{ notes.0.dl_note|safe }}</td></tr>
		</table>
		<hr/>
		<br/>
	</div>
	{% else %}
		<p>No notes found </p>
	{% endif %}
{% endblock %}
	